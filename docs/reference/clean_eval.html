<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Evaluate the cleaning of occurrences records — clean_eval • naturaList</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Evaluate the cleaning of occurrences records — clean_eval" />
<meta property="og:description" content="This function compare the area occupied by
a species before and after pass through the cleaning procedure according to the chosen
level of filter.
The comparison can be made by measuring area in the geographical and in the environmental space" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">naturaList</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/naturaList_grid_filter_vignette.html">Filter within grid cells</a>
    </li>
    <li>
      <a href="../articles/naturaList_map_module_vignette.html">Interacting with naturaList: the map_module() function </a>
    </li>
    <li>
      <a href="../articles/natutaList_clean_eval_vignette.html">Filtering data and evaluating the filtering proccess with naturaList</a>
    </li>
    <li>
      <a href="../articles/natutaList_vignette.html">Introduction to naturaList</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Evaluate the cleaning of occurrences records</h1>
    
    <div class="hidden name"><code>clean_eval.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function compare the area occupied by
a species before and after pass through the cleaning procedure according to the chosen
level of filter.
The comparison can be made by measuring area in the geographical and in the environmental space</p>
    </div>

    <pre class="usage"><span class='fu'>clean_eval</span><span class='op'>(</span>
  <span class='va'>occ.cl</span>,
  <span class='va'>geo.space</span>,
  <span class='va'>env.space</span>,
  level.filter <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1_det_by_spec"</span><span class='op'>)</span>,
  <span class='va'>r</span>,
  scientific.name <span class='op'>=</span> <span class='st'>"species"</span>,
  longitude <span class='op'>=</span> <span class='st'>"decimalLongitude"</span>,
  latitude <span class='op'>=</span> <span class='st'>"decimalLatitude"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>occ.cl</th>
      <td><p>Data frame with occurrence records information already
classified by <code><a href='classify_occ.html'>classify_occ</a></code> function.</p></td>
    </tr>
    <tr>
      <th>geo.space</th>
      <td><p>a SpatialPolygons* or sf object defining the geographical space</p></td>
    </tr>
    <tr>
      <th>env.space</th>
      <td><p>a SpatialPolygons* or sf object defining the environmental space.
Use the <code><a href='define_env_space.html'>define_env_space</a></code> for create this object.</p></td>
    </tr>
    <tr>
      <th>level.filter</th>
      <td><p>a character vector including the levels in 'naturaList_levels'
collumn which filter the occurrence data set.</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>a raster with 2 layers representing the environmental variables</p></td>
    </tr>
    <tr>
      <th>scientific.name</th>
      <td><p>Column name of <code>occ.cl</code> with the species names.</p></td>
    </tr>
    <tr>
      <th>longitude</th>
      <td><p>Column name of <code>occ.cl</code> longitude in decimal degrees.</p></td>
    </tr>
    <tr>
      <th>latitude</th>
      <td><p>Column name of <code>occ.cl</code> latitude in decimal degrees.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list in which:</p>
<p><code>area</code> data frame remaining area after cleaning proportional to the area
  before cleaning. The values vary from 0 to 1. Column named <code>r.geo.area</code>
  is the remaining area for all species in the geographic space and the
  <code>r.env.area</code> in the environmental space.</p>
<p><code>comp</code> data frame with composition of species in sites (cells from raster
  layers) before cleaning (<code>comp$comp$BC</code>) and after cleaning
  (<code>comp$comp$AC</code>). The number of rows is equal the number of cells in
  <code>r</code>, and number of columns is equal to the number of species in the
  <code>occ.cl</code>.</p>
<p><code>rich</code> data frame with a single column with the richness of each site</p>
<p><code>site.coords</code> data frame with site's coordinates. It facilitates to built
  raster layers from results using <code><a href='https://rdrr.io/pkg/raster/man/rasterFromXYZ.html'>rasterFromXYZ</a></code></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>[define_env_space()]</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>pkgs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"devtools"</span>, <span class='st'>"raster"</span>, <span class='st'>"maptools"</span>, <span class='st'>"rnaturalearth"</span>, <span class='st'>"sf"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>pkgs</span>, <span class='va'>require</span>, character.only <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"A.setosa"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"speciaLists"</span><span class='op'>)</span>

<span class='co'># classify</span>
<span class='va'>occ.cl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='classify_occ.html'>classify_occ</a></span><span class='op'>(</span><span class='va'>A.setosa</span>, <span class='va'>speciaLists</span>, spec.ambiguity <span class='op'>=</span> <span class='st'>"not.spec"</span><span class='op'>)</span>
<span class='co'>## check points</span>
<span class='va'>occ.cl</span> <span class='op'>&lt;-</span><span class='fu'><a href='map_module.html'>map_module</a></span><span class='op'>(</span><span class='va'>occ.cl</span><span class='op'>)</span> <span class='co'>#delete points in the ocean</span>

<span class='co'># download climate data</span>
<span class='va'>bioclim</span> <span class='op'>&lt;-</span> <span class='fu'>getData</span><span class='op'>(</span><span class='st'>'worldclim'</span>, var<span class='op'>=</span><span class='st'>'bio'</span>, res<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>

<span class='co'># Transform occurrence data in SpatialPointsDataFrame</span>
<span class='va'>spdf.occ.cl</span> <span class='op'>&lt;-</span> <span class='fu'>SpatialPoints</span><span class='op'>(</span><span class='va'>occ.cl</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"decimalLongitude"</span>, <span class='st'>"decimalLatitude"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>

<span class='co'># redefine the extent of bioclim layers based on buffer around the occurrences</span>
<span class='va'>c.bioclim</span> <span class='op'>&lt;-</span> <span class='fu'>crop</span><span class='op'>(</span><span class='va'>bioclim</span>, <span class='fu'>buffer</span><span class='op'>(</span><span class='va'>spdf.occ.cl</span>, <span class='fl'>100000</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># 100km buffer</span>

<span class='co'># select two layers</span>
<span class='va'>raster.temp.prec</span> <span class='op'>&lt;-</span> <span class='va'>c.bioclim</span><span class='op'>[[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"bio1"</span>, <span class='st'>"bio12"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>]</span>
<span class='va'>df.temp.prec</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>raster.temp.prec</span><span class='op'>)</span>

<span class='co'>### Define the environmental space for analysis</span>
<span class='va'>env.space</span> <span class='op'>&lt;-</span> <span class='fu'><a href='define_env_space.html'>define_env_space</a></span><span class='op'>(</span><span class='va'>df.temp.prec</span>, buffer.size <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>

<span class='co'># delimit the geographic space</span>
<span class='co'># land area</span>
<span class='va'>land</span> <span class='op'>&lt;-</span> <span class='fu'>ne_countries</span><span class='op'>(</span>continent <span class='op'>=</span> <span class='st'>'south america'</span><span class='op'>)</span>
<span class='va'>un.land</span> <span class='op'>&lt;-</span> <span class='fu'>unionSpatialPolygons</span><span class='op'>(</span><span class='va'>land</span>, <span class='va'>land</span><span class='op'>$</span><span class='va'>scalerank</span><span class='op'>)</span>

<span class='co'># geo space based on crop</span>
<span class='va'>c.geo.space</span> <span class='op'>&lt;-</span> <span class='fu'>crop</span><span class='op'>(</span><span class='va'>un.land</span>, <span class='va'>c.bioclim</span><span class='op'>)</span>

<span class='co'>#geo space based on intersect</span>
<span class='va'>i.geo.space</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>intersect</a></span><span class='op'>(</span><span class='va'>un.land</span>, <span class='fu'>buffer</span><span class='op'>(</span><span class='va'>spdf.occ.cl2</span>, <span class='fl'>200000</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>### run the evaluation</span>
<span class='va'>cl.eval</span> <span class='op'>&lt;-</span> <span class='fu'>clean_eval</span><span class='op'>(</span><span class='va'>occ.cl</span>,
                      env.space <span class='op'>=</span> <span class='va'>env.space</span>,
                      geo.space <span class='op'>=</span> <span class='va'>c.geo.space</span>,
                      r <span class='op'>=</span> <span class='va'>raster.temp.prec</span><span class='op'>)</span>

<span class='co'>#area results</span>
<span class='va'>cl.eval</span><span class='op'>$</span><span class='va'>area</span>

<span class='co'>### richness maps</span>
<span class='co'>## it makes sense if there are more than one species</span>
<span class='va'>rich.before.clean</span> <span class='op'>&lt;-</span> <span class='fu'>rasterFromXYZ</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>cl.eval</span><span class='op'>$</span><span class='va'>site.coords</span>,
                                         <span class='va'>cl.eval</span><span class='op'>$</span><span class='va'>rich</span><span class='op'>$</span><span class='va'>rich.BC</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>rich.after.clean</span> <span class='op'>&lt;-</span> <span class='fu'>rasterFromXYZ</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>cl.eval</span><span class='op'>$</span><span class='va'>site.coords</span>,
                                        <span class='va'>cl.eval</span><span class='op'>$</span><span class='va'>rich</span><span class='op'>$</span><span class='va'>rich.AC</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rich.before.clean</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>rich.after.clean</span><span class='op'>)</span>


<span class='co'>### species area map</span>
<span class='va'>comp.bc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>cl.eval</span><span class='op'>$</span><span class='va'>comp</span><span class='op'>$</span><span class='va'>comp.BC</span><span class='op'>)</span>
<span class='va'>comp.ac</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>cl.eval</span><span class='op'>$</span><span class='va'>comp</span><span class='op'>$</span><span class='va'>comp.AC</span><span class='op'>)</span>

<span class='va'>c.setosa.bc</span> <span class='op'>&lt;-</span> <span class='fu'>rasterFromXYZ</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>cl.eval</span><span class='op'>$</span><span class='va'>site.coords</span>,
                                         <span class='va'>comp.bc</span><span class='op'>$</span><span class='va'>`Cyathea setosa`</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>c.setosa.ac</span> <span class='op'>&lt;-</span> <span class='fu'>rasterFromXYZ</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>cl.eval</span><span class='op'>$</span><span class='va'>site.coords</span>,
                                         <span class='va'>comp.ac</span><span class='op'>$</span><span class='va'>`Cyathea setosa`</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>c.setosa.bc</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>c.setosa.ac</span><span class='op'>)</span>

<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Arthur  Vinicius Rodrigues, Gabriel Nakamura, Leandro Duarte.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


